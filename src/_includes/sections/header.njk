<header class="py-4 ~px-4/8 absolute flex w-full z-50{% if page.url != '/' %} bg-white{% endif %} border-b-dashed-custom">
  <div class="container m-auto flex justify-between items-center gap-8">
    <!-- LOGO -->
    <a href="/">
      <svg
        class="h-12 lg:h-20 w-auto"
        alt="Tessuti logo"
        width="266"
        height="75"
        aria-hidden="true"
        draggable="false"
        viewBox="0 0 2200 613.18"
        xmlns="http://www.w3.org/2000/svg">
        <g>
          <g>
            <g>
              <g>
                <path d="M677.95,438.76l59.12-225.67h-87.63l13.36-51.18h232.65l-13.74,51.18h-88.02l-59.12,225.67h-56.61Z"/>
                <path d="M838.54,438.76l72.87-276.85h204.73l-13.36,51.18h-148.12l-16.2,61.65h130.67l-13.74,51.18h-130.67l-15.82,61.65h150.06l-13.74,51.18h-206.67Z"/>
                <path d="M1079.51,368.58c.67-7.76,1.99-13.96,3.1-17.84h57c-.62,2.71-1.25,5.43-1.51,8.53-2.12,24.43,20.88,36.45,49.96,36.45,41.88,0,61.63-13.18,63.55-35.28,4.34-50.02-143.91-21.71-136.34-108.96,5.01-57.77,54.77-95,131.93-95,63.59,0,101.85,28.31,97.01,75.22-.61,6.98-2.44,14.73-3.52,18.22h-56.22c.59-2.33,1.25-5.43,1.55-8.92,2.66-21.71-13.55-36.06-45.34-36.06-40.33,0-61.48,15.9-63.2,35.67-4.34,50.02,145.39,22.49,137.51,108.96-5.26,56.22-46.59,94.61-133.06,94.61-70.96,0-106.03-33.73-102.4-75.61Z"/>
                <path d="M1327.2,368.58c.67-7.76,1.99-13.96,3.1-17.84h57c-.62,2.71-1.25,5.43-1.51,8.53-2.12,24.43,20.88,36.45,49.96,36.45,41.88,0,61.63-13.18,63.55-35.28,4.34-50.02-143.91-21.71-136.34-108.96,5.01-57.77,54.77-95,131.93-95,63.59,0,101.85,28.31,97.01,75.22-.61,6.98-2.44,14.73-3.52,18.22h-56.22c.59-2.33,1.25-5.43,1.55-8.92,2.66-21.71-13.55-36.06-45.34-36.06-40.33,0-61.48,15.9-63.2,35.67-4.34,50.02,145.39,22.49,137.51,108.96-5.26,56.22-46.59,94.61-133.06,94.61-70.96,0-106.03-33.73-102.4-75.61Z"/>
                <path d="M1591.11,329.03l43.96-167.12h56.22l-43.47,165.96c-11.62,44.59,5.63,64.75,51.38,64.75s69.32-21.33,80.87-65.14l43.44-165.57h57l-43.93,166.73c-21.48,82.2-66.63,115.55-147.67,115.55s-119.05-35.67-97.81-115.16Z"/>
                <path d="M1911.63,438.76l59.12-225.67h-87.63l13.36-51.18h232.65l-13.74,51.18h-88.02l-59.12,225.67h-56.61Z"/>
                <path d="M2070.52,438.76l72.87-276.85h56.61l-72.87,276.85h-56.61Z"/>
              </g>
              <g>
                <path d="M1734.16,554.04s7.86,12.02,22.44,12.02c7.53,0,16.03-3.21,16.03-9.14,0-6.41-5.45-9.62-16.83-11.86-15.87-3.21-27.09-9.46-27.09-23.4,0-10.74,10.74-21.32,27.25-21.32,17.47,0,27.41,11.22,27.41,11.22l-8.81,9.14s-7.37-8.18-18.59-8.18c-9.46,0-14.11,4.65-14.11,9.46,0,5.61,5.77,8.66,17.95,11.22,14.49,3.13,26.78,8.62,26.1,24.65-.33,7.85-5.59,14.8-13,17.42-31.43,11.13-48.05-12.57-48.05-12.57l9.3-8.66Z"/>
                <path d="M1826.52,502.26v10.74s7.37-12.67,25-12.67c20.03,0,35.9,17.15,35.9,38.96s-15.87,38.95-35.9,38.95c-13.62,0-21.32-7.7-23.88-11.06v46h-13.47v-110.92h12.34ZM1827.65,553.08s7.05,12.66,21.8,12.66,24.53-11.86,24.53-26.44-9.46-26.45-24.53-26.45-21.8,12.66-21.8,12.66v27.57Z"/>
                <path d="M2056.45,502.26l-4.97,12.18s-2.89-1.6-8.5-1.6c-11.7,0-16.99,12.5-16.99,12.5v50.97h-13.47v-74.06h12.5v11.38s6.57-13.31,20.67-13.31c6.09,0,10.74,1.92,10.74,1.92Z"/>
                <path d="M2078.11,502.28h14.42v-22.6h13.47v22.6h23.08v12.18h-23.08v39.92c0,7.21,3.53,11.38,10.74,11.38,4.17,0,8.5-3.04,8.5-3.04l4.97,11.06c-6.41,3.53-11.06,4.49-15.39,4.49-10.58,0-22.29-6.89-22.29-23.24v-40.56h-14.42v-12.18Z"/>
                <path d="M1985.5,536.7c1.36,23-15.38,41.52-38.01,41.56-20.04.03-36.98-16.37-38.14-36.38-1.34-22.98,15.38-41.48,37.99-41.53,20.04-.04,36.98,16.34,38.16,36.35ZM1972.11,539.31c0-14.59-9.77-26.45-24.68-26.45s-24.69,11.86-24.69,26.45,9.78,26.44,24.69,26.44,24.68-11.86,24.68-26.44Z"/>
              </g>
              <path d="M145.75,137.62C277.75,40.78,450.84,1.29,613.03,8.17c31.3,1.92,62.66,5.76,92.87,14.54-29.83-10.28-61.17-15.67-92.49-19.14C409.17-15.15,186.39,38.8,38.58,187.75c-11.29,11.58-21.89,23.82-31.81,36.59-6.37,7.23-7.91,16.77-6.03,24.74,2.22,9.4,9.14,16.99,18.3,20.08,4.37,1.48,15.7,3.9,26.96-5.1-2.49,2.11-5.29,3.74-8.2,4.76,9.99-3.5,42.78-20.43,145.17-37.18,59.17-9.68,107.53-13.07,143.73-10.07,34.68,2.87,55.55,12.84,62.53,24.79,29.24,50.04-67.8,164.61-86.02,189.26-25.87,35-103.35,120.79-103.35,120.79l228.24-.65s135.08-250.31,85.82-360.25c-17.22-38.44-48.2-53.81-103.85-59.54-24.73-2.55-74.26-3.3-88.69-1.33,18.61-25.61,201.61-120.02,384.51-83.41v-6.29c-163.13-52.63-412.62,12.13-560.15,92.7Z"/>
            </g>
          </g>
        </g>
      </svg>
    </a>

    <!-- NAVIGATION -->
    <nav class="max-lg:hidden max-lg:group-[.mobile-menu]/body:block max-lg:absolute max-lg:top-[calc(100%+0.5rem)] max-lg:left-1/2 max-lg:-translate-x-1/2
      max-lg:w-[calc(100vw-2rem)] max-lg:p-4 max-lg:bg-white max-lg:border-2 max-lg:border-black max-lg:rounded-lg">
      <ul class="flex max-lg:flex-col ~gap-2/8">
        {% set navPages = collections.all | eleventyNavigation %}

        {# Loop through all pages with a eleventyNavigation in the frontmatter #}
        {% for entry in navPages %}

          {# Define a hasChild variable to make it easier to test what navigation items are have child dropdown pages #}
          {% set hasChild = entry.children.length %}

          <li
            class="group/li {% if hasChild -%} dropdown relative {%- else -%} inline-flex {%- endif %}"
            {%- if hasChild -%}tabindex="0"{%- endif -%}
          >

            {# If the page has child dropdown pages, render it as a link + button combination #}
            {% if hasChild %}
              {# Container for the link and dropdown button #}
              <div class="flex items-center">
                {# Main katalog link #}
                <a
                  class="~p-1.5/4 whitespace-nowrap transition-colors duration-300 text-xl font-body max-lg:pl-4 max-lg:border-l-4 max-lg:rounded-r-md
                  {%- if entry.url == page.url %} text-[#E92429] font-semibold text-2xl max-lg:border-l-[#E92429] max-lg:bg-primary/10
                  {%- else %} text-black hover:text-gray-600 hover:underline decoration-dashed{% endif %}"
                  href="{{ entry.url }}"
                  {%- if entry.url == page.url -%}aria-current="page"{%- endif -%}>
                  {{ entry.key }}
                </a>
                
                {# Dropdown toggle button #}
                <button
                  class="dropdown-button px-2 py-1 text-black hover:text-gray-600 transition-colors duration-300"
                  aria-expanded="false"
                  aria-controls="dropdown-{{ entry.key | slug }}"
                  aria-label="Otevřít submenu {{ entry.key }}"
                  type="button"
                >
                  <!-- DROPDOWN ICON -->
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="transition-transform duration-300" viewBox="0 0 16 16">
                    <path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/>
                  </svg>
                </button>
              </div>

              {# Dropdown menu positioned absolutely below the li element #}
              <div class="dropdown-menu
                absolute top-full left-0 z-50 mt-2
                transition-[transform,_opacity] duration-300 lg:scale-y-0 lg:opacity-0 origin-top lg:group-hover/li:scale-y-100 lg:group-hover/li:opacity-100
                max-lg:static max-lg:w-full max-lg:h-0 max-lg:group-[&.active]/li:h-auto max-lg:mt-0">
                <ul
                  id="dropdown-{{ entry.key | slug }}"
                  class="flex flex-col bg-white rounded-lg shadow-lg border border-gray-200 py-2 min-w-[200px]
                    max-lg:bg-transparent max-lg:shadow-none max-lg:border-none max-lg:py-0 max-lg:min-w-0
                    max-lg:hidden max-lg:group-[&.active]/li:flex max-lg:gap-1 max-lg:mt-2 max-lg:mb-4 max-lg:ml-4"
                >
                {% for child in entry.children %}
                  <li class="drop-li lg:transition-[transform,_opacity] lg:duration-200 lg:opacity-0 lg:translate-x-4 lg:group-hover/li:opacity-100 lg:group-hover/li:translate-x-0"
                    style="transition-delay: {{ 100 + 50 * loop.index }}ms;"
                  >
                    <a
                      href="{{ child.url }}"
                      class="li-link block w-full lg:px-4 lg:py-2 max-lg:pl-4 max-lg:py-1 text-sm font-semibold font-body max-lg:border-l-4
                      {%- if child.url == page.url %} text-[#E92429] max-lg:border-l-[#E92429] max-lg:bg-[#E92429]/10 lg:bg-[#E92429]/10
                      {%- else %} text-gray-700 transition-colors duration-200 hover:text-[#E92429] lg:hover:bg-gray-50
                      max-lg:hover:bg-gray-100 max-lg:border-l-gray-300 max-lg:focus:text-black{% endif %}"
                      {%- if child.url == page.url -%}aria-current="page"{%- endif -%}
                    >
                      {{ child.key }}
                    </a>
                  </li>
                {% endfor %}
              </ul>
              </div>
            {% else %}
              {# Normal pages are rendered as <a> tags, in the normal way you'd expect #}
              <a
                class="w-full ~p-1.5/4 whitespace-nowrap transition-colors duration-300 text-xl font-body max-lg:pl-4 max-lg:border-l-4 max-lg:rounded-r-md
                {%- if entry.url == page.url %} text-[#E92429] font-semibold text-2xl max-lg:border-l-[#E92429] max-lg:bg-primary/10
                {%- else %} text-black hover:text-gray-600 hover:underline decoration-dashed{% endif %}"
                href="{{ entry.url }}"
                {%- if entry.url == page.url -%}aria-current="page"{%- endif -%}>
                {{ entry.key }}
              </a>
            {% endif %}
          </li>
        {% endfor %}
      </ul>
    </nav>

    <!-- DARKMODE + CTA -->
    <div class="flex items-center gap-2 lg:gap-4">
      <!-- CTA -->
      <a href="/#contact-form" class="max-lg:hidden bg-[#00A44F] hover:bg-[#008f3f] rounded-lg font-body text-white py-2 px-6 font-semibold transition-colors duration-300">Kontakt</a>

      <!-- MOBILE MENU BUTTON -->
      <button
        id="mobile-menu-toggle"
        class="group lg:hidden flex justify-center items-center gap-1 h-11 w-11 bg-secondary rounded-xl transition-transform duration-300 [&.active]:rotate-90"
        type="button"
        aria-expanded="false"
      >
        <span class="sr-only">Otevřít navigaci</span>
        <span class="relative block h-3.5 w-5">
          <span class="absolute top-0 block h-0.5 w-full bg-black rounded-full transition-transform duration-300 group-[.active]:rotate-45 group-[.active]:top-1/2 group-[.active]:-translate-y-1/2 group-[.active]:left-1/2 group-[.active]:-translate-x-1/2"></span>
          <span class="absolute top-1/2 -translate-y-1/2 block h-0.5 w-full bg-black rounded-full transition-[opacity] duration-300 group-[.active]:opacity-0"></span>
          <span class="absolute bottom-0 block h-0.5 w-full bg-black rounded-full transition-transform duration-300 group-[.active]:rotate-[315deg] group-[.active]:top-1/2 group-[.active]:-translate-y-1/2 group-[.active]:left-1/2 group-[.active]:-translate-x-1/2"></span>
        </span>
      </button>
    </div>
  </div>
</header>